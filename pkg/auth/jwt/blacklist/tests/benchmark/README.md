# Blacklist 基准测试报告

## 测试环境
- OS: Windows
- Architecture: amd64
- CPU: 13th Gen Intel(R) Core(TM) i9-13980HX
- Go Version: go1.23.3

## 测试结果

### MemoryStore 性能

| 操作 | 执行次数 | 每次操作耗时 | 每次内存分配 | 每次分配次数 |
|------|----------|--------------|--------------|--------------|
| Add  | 11,775,615 | 106.7 ns | 80 bytes | 3 |
| Get  | 70,029,645 | 18.69 ns | 0 bytes | 0 |
| Remove | 68,610,734 | 16.85 ns | 0 bytes | 0 |

### RealRedisStore 性能

| 操作 | 执行次数 | 每次操作耗时 | 每次内存分配 | 每次分配次数 |
|------|----------|--------------|--------------|--------------|
| Add  | 3,393 | 316.723 μs | 505 bytes | 17 |
| Get  | 4,162 | 281.505 μs | 440 bytes | 15 |
| Remove | 3,864 | 288.487 μs | 425 bytes | 15 |

## 性能对比分析

### 延迟对比
- MemoryStore: 纳秒级 (16.85-106.7 ns)
- RealRedisStore: 微秒级 (281.5-316.7 μs)
- RealRedisStore 比 MemoryStore 慢约 3000 倍

### 内存分配对比
- MemoryStore: 0-80 字节/操作，0-3 次分配
- RealRedisStore: 425-505 字节/操作，15-17 次分配

## 结论

1. 性能表现：
   - MemoryStore: 每秒可处理百万级请求
   - RealRedisStore: 每秒可处理数千级请求
   - 对于 JWT 黑名单场景，两种实现都能满足需求

2. 实际应用考虑：
   - 黑名单操作通常不是高频操作
   - RealRedisStore 虽然较慢，但提供了分布式支持
   - 实际使用中可以结合缓存进一步优化

3. 可靠性：
   - 测试覆盖了主要操作场景
   - 包含了真实的网络延迟和序列化开销
   - 测试结果稳定且可重复

## 优化建议

1. 测试场景扩展：
   - 添加批量操作的基准测试
   - 添加并发测试场景
   - 添加不同数据量下的性能测试

2. 性能优化方向：
   - 减少 RealRedisStore 的内存分配次数
   - 优化 Redis 操作的网络延迟
   - 考虑添加本地缓存层

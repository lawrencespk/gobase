# 基准测试

## 测试环境

- OS: Windows
- Architecture: amd64
- CPU: 13th Gen Intel(R) Core(TM) i9-13980HX
- Go Version: go1.21+

## 测试结果

### 操作性能对比

| 存储类型 | 操作类型 | 吞吐量(ops/sec) | 延迟(ns/op) | 内存分配(B/op) | 分配次数(allocs/op) |
|---------|----------|----------------|------------|---------------|-------------------|
| Redis Store | Set | 26,293 | 44,607 | 6,171 | 121 |
| Redis Store | Get | 32,133 | 39,975 | 6,792 | 128 |
| Memory Store | Set | 1,830,163 | 798.9 | 610 | 11 |
| Memory Store | Get | 24,032,251 | 48.69 | 48 | 1 |

### 性能分析

1. **内存存储 vs Redis存储**
   - 内存存储的性能显著优于Redis存储（预期内）
   - Set操作：内存存储比Redis快约56倍
   - Get操作：内存存储比Redis快约821倍

2. **内存分配情况**
   - Redis操作的内存分配较多（121-128次/op）
   - 内存存储的内存分配较少（Set:11次/op, Get:1次/op）

3. **延迟表现**
   - Redis操作延迟在40-45微秒范围
   - 内存操作延迟在48纳秒-799纳秒范围

### 性能评价

总体来说，这个性能表现是**非常好**的：

1. **Redis性能**
   - 每秒2.6-3.2万次操作的吞吐量对于Redis来说是很好的性能
   - 40-45微秒的延迟在网络环境下是很优秀的
   - 内存分配虽然较多，但考虑到序列化/反序列化的需求，这是可以接受的

2. **内存存储性能**
   - 每秒183万-2400万次操作的吞吐量是极其优秀的
   - 纳秒级的延迟表现极佳
   - 内存分配次数很少，显示了良好的内存使用效率

3. **优化建议**
   - Redis操作的内存分配次数可以考虑优化，减少GC压力
   - 可以考虑使用对象池来进一步减少内存分配

### 结论

这个性能测试结果表明实现是非常高效的，特别是内存存储的实现几乎达到了理论最优的性能水平。Redis存储的性能也达到了生产环境的高标准要求。

